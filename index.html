<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–í—ã–±–µ—Ä–∏—Ç–µ 3 –∫–∞—Ä—Ç—ã –¢–∞—Ä–æ</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>/* —Å—Ç–∏–ª–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */</style>
</head>
<body>
  <div class="container">
    <h1>–í—ã–±–µ—Ä–∏—Ç–µ 3 –∫–∞—Ä—Ç—ã</h1>
    <div class="cards" id="cards"></div>
    <button id="submitBtn" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä</button>
    <div class="message" id="message"></div>
  </div>

  <script>
    const tg = window.Telegram?.WebApp;
    if (tg) tg.expand();

    // –û–ø–∏—Å–∞–Ω–∏—è –∫–∞—Ä—Ç –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ
    const DESCR = {
      "RWS_Tarot_01_Magician.jpg":  "–ú–∞–≥ ‚Äî —Å–∏–ª–∞ –≤–æ–ª–∏, –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, —Ä–µ—Å—É—Ä—Å—ã",
      "RWS_Tarot_02_High_Priestess.jpg": "–ñ—Ä–∏—Ü–∞ ‚Äî –∏–Ω—Ç—É–∏—Ü–∏—è, —Ç–∞–π–Ω—ã, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ",
      "RWS_Tarot_03_Empress.jpg": "–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞ ‚Äî –ø–ª–æ–¥–æ—Ä–æ–¥–∏–µ, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ, –ø—Ä–∏—Ä–æ–¥–∞",
      "RWS_Tarot_04_Emperor.jpg": "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä ‚Äî –≤–ª–∞—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å",
      "RWS_Tarot_05_Hierophant.jpg": "–ò–µ—Ä–æ—Ñ–∞–Ω—Ç ‚Äî —Ç—Ä–∞–¥–∏—Ü–∏–∏, —É—á–µ–Ω–∏–µ, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å",
      "RWS_Tarot_06_Lovers.jpg": "–í–ª—é–±–ª—ë–Ω–Ω—ã–µ ‚Äî –≤—ã–±–æ—Ä, –≥–∞—Ä–º–æ–Ω–∏—è, –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ",
      "RWS_Tarot_07_Chariot.jpg": "–ö–æ–ª–µ—Å–Ω–∏—Ü–∞ ‚Äî –¥–≤–∏–∂–µ–Ω–∏–µ, —É—Å–ø–µ—Ö, –≤–æ–ª—è –∫ –ø–æ–±–µ–¥–µ",
      "RWS_Tarot_08_Strength.jpg": "–°–∏–ª–∞ ‚Äî –º—É–∂–µ—Å—Ç–≤–æ, –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–∏–ª–∞, —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ",
      "RWS_Tarot_09_Hermit.jpg": "–û—Ç—à–µ–ª—å–Ω–∏–∫ ‚Äî —É–µ–¥–∏–Ω–µ–Ω–∏–µ, –ø–æ–∏—Å–∫, –º—É–¥—Ä–æ—Å—Ç—å"
    };

    const FACES = Object.keys(DESCR),
          BACK  = "back.jpg",
          cardsContainer = document.getElementById("cards"),
          btn = document.getElementById("submitBtn"),
          msg = document.getElementById("message"),
          selected = [];

    // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç
    FACES.forEach(src => {
      const card = document.createElement("div"),
            inner = document.createElement("div"),
            backImg = document.createElement("img"),
            frontImg = document.createElement("img");
      card.className = "card";
      inner.className = "card-inner";
      backImg.src = BACK; backImg.className = "card-back";
      frontImg.src = src;  frontImg.className = "card-front";
      inner.append(backImg, frontImg);
      card.append(inner);
      cardsContainer.append(card);

      card.addEventListener("click", () => {
        if (selected.length >= 3 || card.classList.contains("flipped")) return;
        card.classList.add("flipped");
        selected.push(src);
        if (selected.length === 3) btn.disabled = false;
      });
    });

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –≥–æ—Ç–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –±–æ—Ç—É
    btn.addEventListener("click", () => {
      if (selected.length !== 3) {
        msg.textContent = "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–≤–Ω–æ 3 –∫–∞—Ä—Ç—ã.";
        return;
      }

      // –°–æ–±–∏—Ä–∞–µ–º —Ç–µ–∫—Å—Ç –ø—Ä—è–º–æ —Ç—É—Ç
      let text = "üÉè –°–µ–≥–æ–¥–Ω—è –≤–∞–º –≤—ã–ø–∞–ª–æ:\n";
      selected.forEach(fn => {
        text += `- ${DESCR[fn]}\n`;
      });

      // –§–æ—Ä–º–∏—Ä—É–µ–º payload
      const payload = {
        cards: selected,
        text
      };

      // –®–ª—ë–º –±–æ—Ç—É –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º
      if (tg && tg.sendData) {
        tg.sendData(JSON.stringify(payload));
      }
      setTimeout(() => tg.close(), 100);
    });
  </script>
</body>
</html>
